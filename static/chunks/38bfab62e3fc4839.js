(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,23261,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(76009),r=e.i(18566),i=e.i(97815),l=e.i(22016);e.i(36180);var n=e.i(98925);function o(){let[o,m]=(0,s.useState)("..."),[x,u]=(0,s.useState)(!0),[h,b]=(0,s.useState)({deposits:0,withdrawals:0,revenue:0}),[p,f]=(0,s.useState)([]),g=(0,r.useRouter)(),[j,v]=(0,s.useState)(!1),[N,w]=(0,s.useState)(""),[y,A]=(0,s.useState)("1"),[D,F]=(0,s.useState)(!1),[S,k]=(0,s.useState)(null),{user:C}=(0,i.useAuth)(),[E,_]=(0,s.useState)(null);(0,s.useEffect)(()=>{!async function(){try{if(C){let{getDoc:t,doc:s}=await e.A(27510),r=await t(s(a.db,"users",C.uid));r.exists()&&_(r.data().adminPermissions)}let t=(0,n.collection)(a.db,"users"),s=await (0,n.getCountFromServer)(t);m(s.data().count.toLocaleString());let{getDocs:r}=await e.A(27510),i=await r((0,n.collection)(a.db,"transactions")),l=0,o=0;i.forEach(e=>{let t=e.data();"completed"===t.status&&("deposit"===t.type&&(l+=Number(t.amount)),"withdrawal"===t.type&&(o+=Number(t.amount)))}),b({deposits:l,withdrawals:o,revenue:l-o});let{query:c,orderBy:d,limit:x}=await e.A(27510),u=c((0,n.collection)(a.db,"recent_activity"),d("createdAt","desc"),x(10)),h=(await r(u)).docs.map(e=>({id:e.id,...e.data()}));f(h)}catch(e){console.error("Failed to fetch dashboard data:",e),m("Error")}finally{u(!1)}}()},[C]);let L=async e=>{e.preventDefault(),F(!0),k(null);try{let e=parseInt(y),t=new Date;t.setHours(t.getHours()+e),await (0,n.addDoc)((0,n.collection)(a.db,"offers"),{value:N,duration:e,createdAt:(0,n.serverTimestamp)(),expiresAt:t,active:!0});let s=(await (0,n.getDocs)((0,n.collection)(a.db,"users"))).docs;for(let e=0;e<s.length;e+=450){let t=s.slice(e,e+450),r=(0,n.writeBatch)(a.db);t.forEach(e=>{let t=(0,n.doc)((0,n.collection)(a.db,"notifications"));r.set(t,{recipientId:e.id,title:"ðŸŽ Ø¹Ø±Ø¶ Ù…Ù„ÙƒÙŠ Ø¬Ø¯ÙŠØ¯!",message:`Ø£ÙŠÙ‡Ø§ Ø§Ù„Ù…Ù„ÙƒØŒ Ù‡Ù†Ø§Ùƒ Ø¹Ø±Ø¶ Ø¬Ø¯ÙŠØ¯ Ù…ØªØ§Ø­ Ø§Ù„Ø¢Ù†: ${N}. ÙŠÙ†ØªÙ‡ÙŠ Ø§Ù„Ø¹Ø±Ø¶ Ø®Ù„Ø§Ù„ ${y} Ø³Ø§Ø¹Ø©.`,type:"offer",status:"unread",createdAt:(0,n.serverTimestamp)()})}),await r.commit()}k({type:"success",text:"Offer created and all users notified!"}),w(""),A("1"),setTimeout(()=>{v(!1),k(null)},2e3)}catch(e){console.error("Error creating offer:",e),k({type:"error",text:"Failed to create offer. Please try again."})}finally{F(!1)}};return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("h2",{className:"text-3xl font-bold text-white mb-1",children:"Admin Dashboard"}),(0,t.jsx)("p",{className:"text-gray-400",children:"Welcome back, Administrator. Here's what's happening today."}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,t.jsx)(c,{title:"Total Users",value:o,change:"+12%",icon:"ðŸ‘¥",isLoading:x}),(0,t.jsx)(c,{title:"Deposits",value:`${h.deposits.toLocaleString()} EGP`,change:"+5%",icon:"ðŸ“¥"}),(0,t.jsx)(c,{title:"Withdrawals",value:`${h.withdrawals.toLocaleString()} EGP`,change:"-2%",icon:"ðŸ“¤"}),(0,t.jsx)(c,{title:"Revenue",value:`${h.revenue.toLocaleString()} EGP`,change:"+8%",icon:"ðŸ’°"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mt-12",children:[(0,t.jsxs)("div",{className:"bg-[#0a0a0a] border border-[#D4AF37]/20 p-6 rounded-xl",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-[#FFD700]",children:"Recent Activity"}),(0,t.jsx)(l.default,{href:"/admin/activities",className:"text-[10px] text-[#D4AF37] uppercase font-black hover:underline tracking-widest",children:"View All"})]}),(0,t.jsx)("div",{className:"space-y-4",children:0===p.length?(0,t.jsx)("p",{className:"text-gray-500 text-xs text-center py-10",children:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù†Ø´Ø§Ø·Ø§Øª Ù…Ø³Ø¬Ù„Ø© Ø­Ø§Ù„ÙŠØ§Ù‹"}):p.map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between py-3 border-b border-[#D4AF37]/10 last:border-0",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-full bg-[#D4AF37]/20 flex items-center justify-center text-xs text-[#FFD700]",children:e.icon||"ðŸ“œ"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium",children:e.description||e.title}),(0,t.jsxs)("p",{className:"text-xs text-gray-500",children:[e.createdAt?.toDate().toLocaleTimeString("ar-EG")," - ",e.createdAt?.toDate().toLocaleDateString("ar-EG")]})]})]}),(0,t.jsx)("span",{className:"text-[#D4AF37] text-[10px] uppercase font-bold",children:e.title})]},e.id))})]}),(0,t.jsxs)("div",{className:"bg-[#0a0a0a] border border-[#D4AF37]/20 p-6 rounded-xl",children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-[#FFD700] mb-4",children:"Quick Shortcuts"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(E?.manage_offers||C?.email==="mohemad123hsak@gmail.com")&&(0,t.jsx)(d,{label:"Create Offer",icon:"ðŸŽ",onClick:()=>v(!0)}),(E?.manage_users||C?.email==="mohemad123hsak@gmail.com")&&(0,t.jsx)(d,{label:"User Management",icon:"ðŸ‘¥",onClick:()=>g.push("/admin/users")}),(E?.manage_offers||C?.email==="mohemad123hsak@gmail.com")&&(0,t.jsx)(d,{label:"Broadcast",icon:"ðŸ“¢"}),(0,t.jsx)(d,{label:"Audit Logs",icon:"ðŸ“‹",onClick:()=>g.push("/admin/activities")})]})]})]}),j&&(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4",children:(0,t.jsxs)("div",{className:"bg-[#0a0a0a] border border-[#D4AF37] w-full max-w-md rounded-2xl overflow-hidden shadow-[0_0_50px_rgba(212,175,55,0.1)]",children:[(0,t.jsxs)("div",{className:"bg-gradient-to-r from-[#D4AF37] to-[#FFD700] p-4 text-black font-bold flex justify-between items-center",children:[(0,t.jsxs)("span",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{children:"ðŸŽ"})," Create New Offer"]}),(0,t.jsx)("button",{onClick:()=>v(!1),className:"hover:scale-110 transition-transform",children:"âœ•"})]}),(0,t.jsxs)("form",{onSubmit:L,className:"p-6 space-y-4",children:[S&&(0,t.jsx)("div",{className:`p-3 rounded-lg text-sm font-medium ${"success"===S.type?"bg-green-500/10 text-green-500 border border-green-500/20":"bg-red-500/10 text-red-500 border border-red-500/20"}`,children:S.text}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-xs font-semibold text-[#D4AF37] uppercase tracking-wider",children:"Offer Value"}),(0,t.jsx)("input",{type:"text",required:!0,placeholder:"e.g. 50% Bonus on first deposit",value:N,onChange:e=>w(e.target.value),className:"w-full bg-[#151515] border border-[#D4AF37]/20 rounded-lg p-3 text-white focus:outline-none focus:border-[#D4AF37] transition-colors"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-xs font-semibold text-[#D4AF37] uppercase tracking-wider",children:"Duration (Hours)"}),(0,t.jsx)("input",{type:"number",required:!0,min:"1",value:y,onChange:e=>A(e.target.value),className:"w-full bg-[#151515] border border-[#D4AF37]/20 rounded-lg p-3 text-white focus:outline-none focus:border-[#D4AF37] transition-colors"})]}),(0,t.jsx)("div",{className:"pt-4",children:(0,t.jsx)("button",{type:"submit",disabled:D,className:"w-full bg-gradient-to-r from-[#D4AF37] to-[#FFD700] text-black font-bold py-3 rounded-lg hover:shadow-[0_0_20px_rgba(212,175,55,0.3)] transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:D?"Creating...":"Launch Offer"})})]})]})})]})}function c({title:e,value:s,change:a,icon:r,isLoading:i=!1}){return(0,t.jsxs)("div",{className:"bg-[#0a0a0a] border border-[#D4AF37]/20 p-6 rounded-xl hover:border-[#D4AF37]/50 transition-all group",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("span",{className:"text-2xl group-hover:scale-110 transition-transform",children:r}),(0,t.jsx)("span",{className:"text-green-500 text-xs font-bold",children:a})]}),(0,t.jsx)("p",{className:"text-gray-400 text-sm",children:e}),(0,t.jsx)("div",{className:"flex items-baseline gap-2",children:(0,t.jsx)("p",{className:`text-2xl font-bold text-white ${i?"animate-pulse":""}`,children:s})})]})}function d({label:e,icon:s,onClick:a}){return(0,t.jsxs)("button",{onClick:a,className:"flex flex-col items-center justify-center p-4 bg-[#151515] border border-[#D4AF37]/10 rounded-lg hover:border-[#D4AF37]/40 hover:bg-[#D4AF37]/5 transition-all group",children:[(0,t.jsx)("span",{className:"text-2xl mb-2 group-hover:scale-110 transition-transform",children:s}),(0,t.jsx)("span",{className:"text-sm font-medium text-gray-300 group-hover:text-white",children:e})]})}e.s(["default",()=>o])},27510,e=>{e.v(t=>Promise.all(["static/chunks/54ab083194d7bfbe.js"].map(t=>e.l(t))).then(()=>t(48323)))}]);